from asyncio import sleep
import json
import time
import random
import csv
import os.path
import sys
from pandas import read_csv

project_num = "0"
dir = ".\\Input\\"
# OutputDir = "C:\Users\SudheeM\scio-sync\\"

numberOfFilesStart = int(project_num)
numberOfFilesEnd = numberOfFilesStart + 1

data = {
    "fileInfo":{
        "Ver":"1.0"
        },
    "projectInfo":{
        "project_num":"11",
        "project_name":"abc",
        "customer_name":"Reliance",
        "project_manager":"Robin"
        },
    "pipeinfo":{
        "group_id":"SC20L",
        "pipe_name":"0021",
        "pipe_end":"EndB",
        "pipe_length":"20",
        "pipe_OD":"508",
        "material":"Glass",
        "thickness":"12",
        "type":"Single",
        "sample_size":"360",
        "location":{
            "site_name":"Some yard",
            "latitude":"100",
            "longitude":"100"
            },
        "timestamp":"1702903141",
        "technician_name":"Fake Tech"
        },
    "Data":{
        "radius":[
            "140.962","141.962","145.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962","142.962"],
        "phi":[
            "-3.141593","-3.124091","-3.106589","-3.089087","-3.071585","-3.054083","-3.036581","-3.019079","-3.001577","-2.984075","-2.966574","-2.949072","-2.93157","-2.914068","-2.896566","-2.879064","-2.861562","-2.84406","-2.826558","-2.809056","-2.791554","-2.774053","-2.756551","-2.739049","-2.721547","-2.704045","-2.686543","-2.669041","-2.651539","-2.634037","-2.616535","-2.599033","-2.581532","-2.56403","-2.546528","-2.529026","-2.511524","-2.494022","-2.47652","-2.459018","-2.441516","-2.424014","-2.406512","-2.389011","-2.371509","-2.354007","-2.336505","-2.319003","-2.301501","-2.283999","-2.266497","-2.248995","-2.231493","-2.213991","-2.19649","-2.178988","-2.161486","-2.143984","-2.126482","-2.10898","-2.091478","-2.073976","-2.056474","-2.038972","-2.02147","-2.003969","-1.986467","-1.968965","-1.951463","-1.933961","-1.916459","-1.898957","-1.881455","-1.863953","-1.846451","-1.828949","-1.811448","-1.793946","-1.776444","-1.758942","-1.74144","-1.723938","-1.706436","-1.688934","-1.671432","-1.65393","-1.636428","-1.618927","-1.601425","-1.583923","-1.566421","-1.548919","-1.531417","-1.513915","-1.496413","-1.478911","-1.461409","-1.443907","-1.426406","-1.408904","-1.391402","-1.3739","-1.356398","-1.338896","-1.321394","-1.303892","-1.28639","-1.268888","-1.251386","-1.233885","-1.216383","-1.198881","-1.181379","-1.163877","-1.146375","-1.128873","-1.111371","-1.093869","-1.076367","-1.058865","-1.041364","-1.023862","-1.00636","-0.988858","-0.971356","-0.953854","-0.936352","-0.91885","-0.901348","-0.883846","-0.866344","-0.848843","-0.831341","-0.813839","-0.796337","-0.778835","-0.761333","-0.743831","-0.726329","-0.708827","-0.691325","-0.673823","-0.656322","-0.63882","-0.621318","-0.603816","-0.586314","-0.568812","-0.55131","-0.533808","-0.516306","-0.498804","-0.481302","-0.463801","-0.446299","-0.428797","-0.411295","-0.393793","-0.376291","-0.358789","-0.341287","-0.323785","-0.306283","-0.288781","-0.27128","-0.253778","-0.236276","-0.218774","-0.201272","-0.18377","-0.166268","-0.148766","-0.131264","-0.113762","-0.09626","-0.078759","-0.061257","-0.043755","-0.026253","-0.008751","0.008751","0.026253","0.043755","0.061257","0.078759","0.09626","0.113762","0.131264","0.148766","0.166268","0.18377","0.201272","0.218774","0.236276","0.253778","0.27128","0.288781","0.306283","0.323785","0.341287","0.358789","0.376291","0.393793","0.411295","0.428797","0.446299","0.463801","0.481302","0.498804","0.516306","0.533808","0.55131","0.568812","0.586314","0.603816","0.621318","0.63882","0.656322","0.673823","0.691325","0.708827","0.726329","0.743831","0.761333","0.778835","0.796337","0.813839","0.831341","0.848843","0.866344","0.883846","0.901348","0.91885","0.936352","0.953854","0.971356","0.988858","1.00636","1.023862","1.041364","1.058865","1.076367","1.093869","1.111371","1.128873","1.146375","1.163877","1.181379","1.198881","1.216383","1.233885","1.251386","1.268888","1.28639","1.303892","1.321394","1.338896","1.356398","1.3739","1.391402","1.408904","1.426406","1.443907","1.461409","1.478911","1.496413","1.513915","1.531417","1.548919","1.566421","1.583923","1.601425","1.618927","1.636428","1.65393","1.671432","1.688934","1.706436","1.723938","1.74144","1.758942","1.776444","1.793946","1.811448","1.828949","1.846451","1.863953","1.881455","1.898957","1.916459","1.933961","1.951463","1.968965","1.986467","2.003969","2.02147","2.038972","2.056474","2.073976","2.091478","2.10898","2.126482","2.143984","2.161486","2.178988","2.19649","2.213991","2.231493","2.248995","2.266497","2.283999","2.301501","2.319003","2.336505","2.354007","2.371509","2.389011","2.406512","2.424014","2.441516","2.459018","2.47652","2.494022","2.511524","2.529026","2.546528","2.56403","2.581532","2.599033","2.616535","2.634037","2.651539","2.669041","2.686543","2.704045","2.721547","2.739049","2.756551","2.774053","2.791554","2.809056","2.826558","2.84406","2.861562","2.879064","2.896566","2.914068","2.93157","2.949072","2.966574","2.984075","3.001577","3.019079","3.036581","3.054083","3.071585","3.089087","3.106589","3.124091","3.141593"]
        }
  }

def generate_random_values():
    lower_limit = 192
    upper_limit = 194
    num_values = 360

    random_values = [str(random.uniform(lower_limit, upper_limit)) for _ in range(num_values)]
    return random_values

def json_create():    
  file_list = os.listdir(dir)
  for file in file_list:
    i = 0
    file1 = ".\\Input\\" + file
    data["Data"]['radius'] = read_csv(file1)['Zcog'].tolist()

    print(len( data["Data"]['phi']))

    data['projectInfo']['project_num'] = project_num
    data["pipeinfo"]["pipe_name"] = project_num + "_" + file[:-6]
    data["pipeinfo"]["pipe_end"] =  "End" + file[-5]
    data["pipeinfo"]['timestamp'] = str(int(time.time()) - (i % 6)* 86380*2)
    filename = 'Output\\' + data["pipeinfo"]["pipe_name"] + data["pipeinfo"]["pipe_end"] + '.json'
    print(filename)
    with open(filename, 'w') as f :
      json.dump(data,f)
    i += 1


length = len(sys.argv)
if length < 2 :
  print('usage ***** python3.11.exe .\\jsoncreate.py <project no> ****')
else:
  project_num = str(sys.argv[1])
  json_create()





   

# for i in  range(numberOfFilesStart, numberOfFilesEnd):
#   data["pipeinfo"]["pipe_name"] = str(i)
#   data["pipeinfo"]["pipe_end"] =  "EndA"
#   data["pipeinfo"]['timestamp'] = str(int(time.time()) - (i % 6)* 86380*2)
#   data["Data"]['radius'] = generate_random_values()
#   filename = 'Output\\' + data['projectInfo']['project_num'] +"_"+ data["pipeinfo"]["pipe_name"] + data["pipeinfo"]["pipe_end"] + '.json'
#   print(filename)
#   with open(filename, 'w') as f :
#     json.dump(data,f)
  
#   data["pipeinfo"]["pipe_end"] =  "EndB"
#   filename = 'Output\\' + data['projectInfo']['project_num'] +"_"+ data["pipeinfo"]["pipe_name"] + data["pipeinfo"]["pipe_end"] + '.json'
#   print(filename)
#   with open(filename, 'w') as f :
#     json.dump(data,f)
  
#   #time.sleep(4)
